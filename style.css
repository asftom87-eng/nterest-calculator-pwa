function calculateInterest() {
    // 1. å–å¾—æ‰€æœ‰è¼¸å…¥å€¼
    const principal = parseFloat(document.getElementById('principal').value);
    const years = parseFloat(document.getElementById('years').value);
    const ratePercentage = parseFloat(document.getElementById('interestRate').value);
    const compoundType = document.getElementById('compound').value;
    const rateType = document.getElementById('rateType').value;

    // æª¢æŸ¥è¼¸å…¥æ˜¯å¦æœ‰æ•ˆ
    if (isNaN(principal) || isNaN(years) || isNaN(ratePercentage) || principal < 0 || years <= 0 || ratePercentage < 0) {
        alert("è«‹è¼¸å…¥æœ‰æ•ˆçš„æœ¬é‡‘ã€å¹´æ•¸å’Œå¹´åˆ©ç‡ï¼");
        return;
    }

    // å°‡ç™¾åˆ†æ¯”è½‰æ›ç‚ºå°æ•¸ (r / 100)
    const annualRate = ratePercentage / 100;

    let totalInterest = 0;
    let futureValue = 0;

    // 2. åŸ·è¡Œè¨ˆç®—é‚è¼¯
    if (compoundType === 'simple') {
        // å–®åˆ©è¨ˆç®—: I = P * r * t
        totalInterest = principal * annualRate * years;
        futureValue = principal + totalInterest;

    } else if (compoundType === 'compound') {
        // è¤‡åˆ©è¨ˆç®—: FV = P * (1 + r)^t
        // å‡è¨­ä¸€å¹´è¨ˆæ¯ä¸€æ¬¡ (æ¯å¹´è¤‡åˆ©)
        futureValue = principal * Math.pow((1 + annualRate), years);
        totalInterest = futureValue - principal;
    }

    // 3. æ ¼å¼åŒ–çµæœ
    const interestFormatted = totalInterest.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    const futureValueFormatted = futureValue.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    
    // 4. æ›´æ–°çµæœé¡¯ç¤ºå€
    document.getElementById('totalInterest').textContent = `NT$ ${interestFormatted}`;
    document.getElementById('futureValue').textContent = `NT$ ${futureValueFormatted}`;

    // é¡¯ç¤ºåˆ©ç‡é¡å‹
    let displayRateText = "";
    if (rateType === 'general') {
        displayRateText = `ä¸€èˆ¬éŠ€è¡Œå…¬å‘Šåˆ©æ¯ (${ratePercentage}%)`;
    } else {
        displayRateText = `ğŸŒŸ å„ªæƒ é«˜åˆ© (${ratePercentage}%)`;
    }
    document.getElementById('displayRateType').textContent = displayRateText;
    
    // é¡¯ç¤ºè¨ˆç®—æ–¹å¼
    const displayCompoundText = compoundType === 'simple' ? 'å–®åˆ©' : 'è¤‡åˆ© (æ¯å¹´è¤‡åˆ©)';
    document.getElementById('displayCompound').textContent = displayCompoundText;
}

// è¨­ç½®åˆå§‹é¡¯ç¤ºï¼Œé¿å…å‰›è¼‰å…¥æ™‚ç‚ºç©ºç™½
document.addEventListener('DOMContentLoaded', () => {
    // æ ¹æ“šä¸‹æ‹‰é¸å–®çš„é è¨­å€¼ï¼Œè¨­å®šåˆå§‹é¡¯ç¤º
    document.getElementById('displayRateType').textContent = "ä¸€èˆ¬éŠ€è¡Œå…¬å‘Šåˆ©æ¯ (1.5%)";
    document.getElementById('displayCompound').textContent = "å–®åˆ©";
});
